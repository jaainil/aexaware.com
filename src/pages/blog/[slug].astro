---
import SiteLayout from "@/layouts/SiteLayout.astro";
import { Button } from "@/components/ui/button";
import { ArrowLeft, Calendar, User } from "lucide-react";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<SiteLayout
  title={post.data.title}
  description={post.data.description}
>
  <div class="min-h-screen bg-background font-sans">
    <article class="pt-32 pb-24 lg:pt-48 lg:pb-32">
      <div class="container mx-auto px-6 lg:px-8 max-w-3xl">
        <div class="mb-8">
          <Button
            variant="ghost"
            asChild
            className="-ml-4 text-muted-foreground hover:text-primary"
          >
            <a href="/blog">
              <ArrowLeft className="mr-2 h-4 w-4" />
              Back to Blog
            </a>
          </Button>
        </div>

        <div class="mb-10">
          <div class="flex flex-wrap gap-2 mb-6">
            {post.data.tags?.map((tag) => (
              <span
                class="inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80"
              >
                {tag}
              </span>
            ))}
          </div>
          <h1 class="font-serif text-4xl md:text-5xl font-medium leading-tight text-foreground mb-6">
            {post.data.title}
          </h1>
          <div class="flex items-center gap-6 text-muted-foreground text-sm">
            <div class="flex items-center gap-2">
              <User className="size-4" />
              {post.data.author}
            </div>
            <div class="flex items-center gap-2">
              <Calendar className="size-4" />
              {post.data.date}
            </div>
          </div>
          {post.data.image && (
            <div class="mt-8 aspect-video rounded-3xl overflow-hidden bg-muted">
              <img
                src={post.data.image}
                alt={post.data.title}
                class="w-full h-full object-cover"
              />
            </div>
          )}
        </div>

        <div class="prose prose-lg prose-slate dark:prose-invert max-w-none prose-headings:font-serif prose-headings:font-medium prose-h1:text-4xl prose-h1:leading-tight prose-p:text-muted-foreground prose-p:leading-relaxed prose-a:text-primary prose-a:no-underline hover:prose-a:underline prose-img:rounded-3xl prose-img:shadow-lg">
          <Content />
        </div>
      </div>
    </article>
  </div>
</SiteLayout>
